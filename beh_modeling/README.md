# Behavioral Modeling (`beh_modeling`)

This directory contains the hierarchical Bayesian modeling framework used to quantify discrimination learning. The modeling approach is described in the manuscript (Methods: *Modeling discrimination learning*) and provides trial-wise value trajectories (`w`) for each odor-predictive stimulus. These estimates were subsequently used as regressors when analyzing choice behavior and evaluating the effects of TMS on Day 2.

---

## Folder Overview

### `model_code/`
- **learning_model.txt**  
  JAGS code implementing the hierarchical Bayesian Rescorla–Wagner learning model.  
- **model_description.md**  
  Documentation of the model specification, priors, and fitting procedure (mirrors manuscript description).

### `results/`
- **df_w_per_sub_sess_cuepair.csv**  
  **End-of-learning value (`w`) per Subject × Session × CuePair.** This is the terminal value after the cue pair’s last presentation within a session (12 values per session). The figure **`w_end_learning_by_sub_sess.pdf`** plots this file directly and we also use these session-level values as covariates in downstream analyses.  
- **posterior_design_arrays.rds**  
  Design arrays associated with posterior samples, used for plotting and extracting trial-wise predictions.  
- **posterior_learning_model.rds**  
  Full posterior output from JAGS sampling (large file, not version-controlled on GitHub; can be regenerated by running `run_learning_model_jags.R`).  
- **w_end_learning_by_sub_sess.pdf**  
  Summary visualization of end-of-session learning (`w` end values) by subject and session.

### `scripts/`
- **run_learning_model_jags.R**  
  Main script to fit the hierarchical Bayesian model in JAGS and save posterior outputs.  
- **extract_posterior_summaries.R**  
  Extracts group- and subject-level parameter summaries.  
- **plot_conditioning_w_byTMS_bySess.R**  
  Generates plots of modeled learning trajectories (`w`) grouped by TMS condition and session.

---

## Role in Manuscript
- **Purpose:** This modeling quantifies how subjects learned odor associations during the discrimination task (Day 1).  
- **Position in manuscript:** Outputs from this folder are used in the *Behavioral Modeling* subsection of the Methods and feed into analyses of Day 2 probe choices and TMS effects.  
- **Key link:** Individualized `w` trajectories allow us to test whether choice behavior is guided by learned value differences and whether TMS modulated this learning-dependent behavior.
